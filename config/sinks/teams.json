{
  "id": "teams",
  "type": "webhook",
  "name": "Microsoft Teams Webhook",
  "enabled": false,
  "config": {
    "url": "${TEAMS_WEBHOOK_URL}",
    "method": "POST"
  },
  "template": {
    "themeColor": "0076D7",
    "format": "json"
  },
  "payloadTransforms": [
    {
      "name": "teams-card",
      "priority": 100,
      "bodyFormat": "json",
      "contentType": "application/json",
      "jsonTemplate": {
        "@type": "MessageCard",
        "@context": "https://schema.org/extensions",
        "themeColor": "{{themeColor}}",
        "title": "{{title}}",
        "text": "{{body}}",
        "sections": [
          {
            "facts": [
              {
                "name": "Server",
                "value": "{{context.server.displayName}}"
              },
              {
                "name": "Channel",
                "value": "{{context.target.name}}"
              },
              {
                "name": "From",
                "value": "{{context.sender.nickname}}"
              }
            ]
          }
        ]
      }
    }
  ],
  "allowedMetadata": [
    "title",
    "body",
    "themeColor",
    "sections",
    "potentialAction"
  ],
  "metadata": {
    "description": "Send notifications to Microsoft Teams channels via webhook"
  }
}